# 온라인 회의/브레인스토밍 서비스 개요 (Spring Boot 3 + React TypeScript)

## 1. 프로젝트 개요

### 1.1 서비스 한 줄 소개

실시간 채팅 + WebRTC 음성 통화 + FigJam 느낌의 협업 화이트보드를 한 공간에서 제공하는 “온라인 회의/브레인스토밍” 서비스

### 1.2 목표

- “회의”에 필요한 **커뮤니케이션(채팅/음성)**과 **협업(화이트보드/노트/액션아이템)**을 하나의 룸에서 해결
- 회의가 끝나도 결과물이 남는 구조(회의록/보드 내보내기/요약/로그)

### 1.3 핵심 차별점

- 화이트보드: 스티커/포스트잇/도형/화살표 + **커서 프레즌스 + 버전 히스토리/리플레이 + 템플릿**
- 회의 문서화: 공유 노트 + 액션아이템 + 회의 종료 시 자동 요약/키워드 태그
- 운영/확장: WebSocket 멀티 인스턴스 확장(Redis Pub/Sub), 품질 지표, 관리자 페이지

---

## 2. 사용자/권한 모델

### 2.1 역할(Role)

- **HOST(호스트)**: 방 잠금/비밀번호/초대코드, 강퇴, 음소거 강제, 발표자 지정, 공지 고정, 룸 설정
- **PRESENTER(발표자)**: 화면 공유(가능 시), 발표자 핀/레이아웃 제어(권한 범위 내)
- **MEMBER(참가자)**: 채팅/음성/화이트보드 기본 사용, 손들기/리액션
- **ADMIN(운영자)**: 신고/방/유저 관리, 감사 로그 확인

### 2.2 룸 접근

- 공개/비공개/팀 전용
- **초대 링크(만료/1회용)**, 이메일 초대, 비밀번호 입장

---

## 3. 기능 범위(전체 포함)

### 3.1 회의 기본 경험

- **대기실(로비)**: 닉네임 설정, 마이크 테스트, 권한 확인
- 참가자 목록 + 상태(마이크/스피커/온라인/발언 중 표시)
- 손들기/리액션(이모지), “이모지 폭죽”
- 호스트 기능: 강퇴, 음소거, 발표자 지정, 방 잠금(비밀번호/초대코드)
- **발표자 핀(고정)**, 레이아웃(발표자 중심/그리드 등)
- (가능하면) **화면 공유**
- **자동 재연결**: 네트워크 끊김 시 WS/WebRTC 재시도 + 상태 복구

### 3.2 실시간 채팅

- 룸 채팅(실시간)
- 멘션(@user), 답장(쓰레드), 공지/고정 메시지
- 파일/이미지 업로드(화이트보드 스크린샷 공유 포함)
- 링크 미리보기(OG)
- 채팅 검색, “회의 키워드 태그” 생성

### 3.3 WebRTC 음성 통화

- 기본: P2P Mesh(소규모)로 MVP
- 확장: SFU(미디어 서버) 도입 가능 구조
- 통화 품질 지표: 지연/패킷로스/bitrate 표시
- STUN/TURN 기반 NAT 대응(배포 환경에서 TURN 옵션 고려)

### 3.4 화이트보드(FigJam 느낌)

- 드로잉(펜/지우개), 텍스트 박스, 도형, 화살표
- 스티커/포스트잇, 레이저 포인터
- 선택/이동/그룹/정렬/스냅 그리드, 미니맵
- **커서 프레즌스(다른 사람 커서 표시)**
- 보드 페이지 여러 장 + 템플릿(회의록/브레인스토밍/칸반)
- 버전 히스토리/되돌리기, 타임라인 리플레이
- 이미지 붙여넣기, PNG/PDF 내보내기

### 3.5 기록/문서화

- 공유 회의 노트(공동 편집)
- 액션아이템 체크리스트(담당자/기한/상태)
- 타임스탬프 북마크(중요 시점 저장)
- 회의 종료 시 자동 요약(주요 안건/결정/할 일)
- 회의록 템플릿 자동 생성(스크럼/1:1/회고)

### 3.6 일정/초대/공유

- 초대 링크 + 이메일 초대
- 캘린더 연동(ICS 다운로드/구글 캘린더 링크)
- 워크스페이스(팀) 단위 룸 관리(프로젝트 룸/팀 룸)

### 3.7 보안/신뢰성/운영

- REST: JWT 인증
- WebSocket: CONNECT 시 JWT 검증 + 룸 권한 체크
- Rate limit / 스팸 방지, (옵션) 욕설/스팸 필터
- 감사 로그(입장/퇴장/강퇴/권한변경 등)
- 오류 리포트/피드백
- 관리자 페이지(유저/방/신고/로그)

### 3.8 재미/차별화

- 룸 배경 테마(다크/네온 등)
- 브레인스토밍 모드(타이머 + 익명 포스트잇 + 투표)
- 투표/설문(A/B/C)
- AI 회의 코치(“논점 정리/다음 액션 제안” 버튼)

---

## 4. 기술 스택/아키텍처

### 4.1 Frontend (React + TypeScript)

- UI: MUI 또는 Mantine(선택)
- 상태/데이터: Zustand + React Query
- Realtime: WebSocket(STOMP) 클라이언트
- WebRTC: RTCPeerConnection(MediaStream)
- 화이트보드: (추천) Excalidraw 기반 UI + (추천) CRDT(Yjs)로 동기화
- 파일 업로드: presigned URL(S3/Cloud Storage) 또는 서버 업로드

### 4.2 Backend (Spring Boot 3)

- REST API: Spring MVC, Spring Security(JWT)
- WebSocket: Spring WebSocket + STOMP
- 확장: Redis Pub/Sub(멀티 인스턴스 WS 브로드캐스트)
- DB: MariaDB/PostgreSQL 중 택1(룸/멤버/로그/노트/액션아이템)
- 로그/모니터링: Actuator + 로그 수집(선택)

### 4.3 배포 구성(예)

- Nginx: HTTPS 종단 + WebSocket 업그레이드 프록시
- 서버: Spring Boot 3 (API + WS)
- (선택) Redis
- (선택) TURN(coturn)
- (선택) SFU(확장 단계)

---

## 5. 데이터 모델(초안)

- users(id, email, username, profile, role_global, created_at…)
- workspaces(id, name, owner_id…)
- rooms(id, workspace_id, title, visibility, password_hash?, invite_policy, host_id, created_at…)
- room_members(room_id, user_id, role_in_room, joined_at, last_seen…)
- chat_messages(id, room_id, user_id, type(text/file/image), content, created_at, pinned?)
- room_events(id, room_id, type(join/leave/mute/kick/hand/emoji…), payload, created_at)
- notes(id, room_id, content, updated_at) // 공유 노트
- action_items(id, room_id, assignee_id, title, due_date, status, created_at)
- whiteboard_snapshots(id, room_id, page_no, data_blob, version, created_at)
- whiteboard_events(id, room_id, data_blob, created_at) // 또는 CRDT 업데이트 로그
- polls(id, room_id, question, options_json, is_anonymous, created_at)
- audit_logs(id, actor_id, room_id, action, metadata, created_at)
- reports(id, reporter_id, target_type, target_id, reason, created_at)

---

## 6. 실시간 채널/메시지 설계(개요)

### 6.1 WS 토픽 예시

- 채팅: `/topic/room/{roomId}/chat`
- 룸 이벤트: `/topic/room/{roomId}/event`
- WebRTC 시그널링: `/topic/room/{roomId}/signal`
- 화이트보드 동기화: `/topic/room/{roomId}/board`
- 개인 큐(개별 알림/권한변경 등): `/user/queue/notice`

### 6.2 메시지 타입 예시

- event: JOIN / LEAVE / MUTE / KICK / ROLE_CHANGE / HAND_UP / REACTION
- signal: OFFER / ANSWER / ICE / PEER_JOIN / PEER_LEAVE
- board: DRAW / SHAPE / TEXT / CURSOR / SNAPSHOT / UNDO / REDO / PAGE_CHANGE
- note/action: NOTE_UPDATE / ACTION_CREATE / ACTION_UPDATE
- poll: POLL_CREATE / VOTE / POLL_RESULT

---

## 7. 개발 로드맵(권장)

### Phase 1: 룸 + 인증 + 채팅

- JWT 로그인, 룸 생성/입장/초대링크
- WebSocket(STOMP) 채팅 + 참가자 목록/입장퇴장 이벤트
- 기본 호스트 권한(강퇴/방 잠금)

### Phase 2: WebRTC 음성(소규모)

- 시그널링(offer/answer/ice) WS로 구현
- 마이크 테스트/대기실, 음소거/발언중 표시
- 품질 지표(간단)

### Phase 3: 화이트보드 MVP

- 기본 드로잉/도형/텍스트
- 커서 프레즌스
- 내보내기(PNG) + 파일 공유

### Phase 4: “FigJam급” 협업 + 문서화

- 템플릿/페이지/미니맵/그룹/스냅
- 버전 히스토리/리플레이
- 공유 노트 + 액션아이템 + 타임스탬프 북마크
- 투표/브레인스토밍 모드

### Phase 5: 운영/확장

- Redis로 WS 멀티 인스턴스
- TURN/SFU 도입 검토
- 관리자/신고/감사로그, 오류 리포트
